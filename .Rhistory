college=College
fix(college)
rownames(college)=college[,1]
fix(college)
summary(college)
pairs(college)
pairs(college[,1:10])
str(college$Private)
plot?
?plot
?plot
plot(college$Private, college$Outstate, col = c(2,3), varwidth=T, xlab="Elite University", ylab="Out of State Tuition in USD", main="Outstate Tuition plot")
plot(college$Private, college$Outstate, col = c(2,3), varwidth=T, xlab="Elite University", ylab="Out of State Tuition in USD", main="Outstate Tuition plot")
plot(college$Private, college$Outstate, col = c(2,3), varwidth=T, xlab="Private University", ylab="Out of State Tuition in USD", main="Outstate Tuition plot")
Elite=rep("No",nrow(college))
head(college, 5)
Elite[college$Top10perc>50]="Yes"
head(college,5)
Elite=as.factor(Elite)
head(college,5)
college=data.frame(college,Elite)
head(college,5)
plot(collge$Elite, collge$Outstate, col=c(2,3), varwidth=T, xlab="Elite University", ylab="Out of state Tuition in USD", main = "Outstage Tuition plot")
plot(collge$Elite, collge$Outstate, col=c(2,3), varwidth=T, xlab="Elite University", ylab="Out of state Tuition in USD", main = "Outstage Tuition plot")
plot(college$Elite, college$Outstate, col=c(2,3), varwidth=T, xlab="Elite University", ylab="Out of state Tuition in USD", main = "Outstage Tuition plot")
par(mfrow=c(2,2))
hist(college$Books, col=2, breaks=50, xlab="Books", ylab="Count")
hist(college$PHD, col=3, breaks=50, xlab="PhD", ylab="Count")
hist(college$Grad.Rate, col=4, breaks=50, xlab="Grad Rate", ylab="Count")
hist(college$perc.alumni, col=6, breaks=50, xlab="% alumni who donate", ylab="Count")
hist(college$PhD, col=3, breaks=50, xlab="PhD", ylab="Count")
summary(collge$PhD)
summary(college$PhD)
nrow(subset=college[college$PhD==103,])
nrow(subset1=college[college$PhD==103,])
nrow(subset1<-college[college$PhD==103,])
row.names(subset1)
summary(team_stats_by_season$playoffs)
team_stats_by_season[,12]= sub("^$", "0", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*1st.*", "1", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*Semis", "2", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*Conf\\.\\sFinals", "3", team_stats_by_season[,12])
team_stats_by_season[,12]= sub("Lost\\sFinals", "4", team_stats_by_season[,12])
team_stats_by_season[,12]= sub("Won.*", "5", team_stats_by_season[,12])
head(team_stats_by_season, 40)
team_stats_by_season = read.csv("raw/teams.csv")
lapply(team_stats_by_season, class)
summary(team_stats_by_season$playoffs)
team_stats_by_season[,12]= sub("^$", "0", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*1st.*", "1", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*Semis", "2", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*Conf\\.\\sFinals", "3", team_stats_by_season[,12])
team_stats_by_season[,12]= sub("Lost\\sFinals", "4", team_stats_by_season[,12])
team_stats_by_season[,12]= sub("Won.*", "5", team_stats_by_season[,12])
head(team_stats_by_season, 40)
team_stats_by_season = read.csv("raw/teams.csv")
setwd('/Users/cgarvey/Documents/NBA/bball/')
library(plyr)
library(ggplot2)
library(scatterplot3d)
team_stats_by_season = read.csv("raw/teams.csv")
team_stats_by_season = read.csv("raw/teams.csv")
lapply(team_stats_by_season, class)
summary(team_stats_by_season$playoffs)
team_stats_by_season[,12]= sub("^$", "0", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*1st.*", "1", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*Semis", "2", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*Conf\\.\\sFinals", "3", team_stats_by_season[,12])
team_stats_by_season[,12]= sub("Lost\\sFinals", "4", team_stats_by_season[,12])
team_stats_by_season[,12]= sub("Won.*", "5", team_stats_by_season[,12])
head(team_stats_by_season, 40)
head(payouts_2014[order(-team_stats_by_season$w),])
head(team_stats_by_season[order(-team_stats_by_season$w),])
attach(team_stats_by_season)
p1 <-
ggplot(ChickWeight, aes(x=Time, y=weight, colour=Diet, group=Chick)) +
geom_line() +
ggtitle("Growth curve for individual chicks")
# Second plot
p2 <-
ggplot(ChickWeight, aes(x=Time, y=weight, colour=Diet)) +
geom_point(alpha=.3) +
geom_smooth(alpha=.2, size=1) +
ggtitle("Fitted growth curve per diet")
# Third plot
p3 <-
ggplot(subset(ChickWeight, Time==21), aes(x=weight, colour=Diet)) +
geom_density() +
ggtitle("Final weight, by diet")
# Fourth plot
p4 <-
ggplot(subset(ChickWeight, Time==21), aes(x=weight, fill=Diet)) +
geom_histogram(colour="black", binwidth=50) +
facet_grid(Diet ~ .) +
ggtitle("Final weight, by diet") +
theme(legend.position="none")        # No legend (redundant in this graph)
multiplot(p1, p2, p3, p4, cols=2)
library(ggplot2)
multiplot(p1, p2, p3, p4, cols=2)
attach(team_stats_by_season)
plotM<-function(l){
df.temp<-team_stats_by_season[team_stats_by_season$season==l,]
plot(df.temp$rel_drtg,df.temp$w,xlab="rel_drtg",ylab="wins",
main=paste("rel_drtg vs. wins: ",toString(l)))
abline(lm(df.temp$z~df.temp$y),col="red")
}
#
par(mfrow=c(5,5))
for (i in length(unique(season))){
plotM(i)
}
par(mfrow=c(3,3))
# Loop through each value of "a" and call the plotM function
for (i in length(unique(season))){
plotM(i)
}
plotM(i)
plotM(1991)
plotM<-function(l){
df.temp<-team_stats_by_season[team_stats_by_season$season==l,]
plot(df.temp$rel_drtg,df.temp$w,xlab="rel_drtg",ylab="wins",
main=paste("rel_drtg vs. wins: ",toString(l)))pl;.
abline(lm(df.temp$z~df.temp$y),col="red")
}
plotM<-function(2000){
df.temp<-team_stats_by_season[team_stats_by_season$season==l,]
plot(df.temp$rel_drtg,df.temp$w,xlab="rel_drtg",ylab="wins",
main=paste("rel_drtg vs. wins: ",toString(l)))pl;.
abline(lm(df.temp$z~df.temp$y),col="red")
}
df.temp<-team_stats_by_season[team_stats_by_season$season==2000,]
plot(df.temp$rel_drtg,df.temp$w,xlab="rel_drtg",ylab="wins",
main=paste("rel_drtg vs. wins: ",toString(l)))pl;.
df.temp<-team_stats_by_season[team_stats_by_season$season==2000,]
plot(df.temp$rel_drtg,df.temp$w,xlab="rel_drtg",ylab="wins",
main=paste("rel_drtg vs. wins: ",toString(2000)))pl;.
plot
head(team_stats_by_season, 40)
top_teams = subset(team_stats_by_season, playoffs>0)
head(top_teams, 40)
plot(playoffs,w)
par(mfrow=c(2,2))
par(mfrow=c(2,2))
plot(playoffs,w)
attach(top_teams)
plot(playoffs,w)
head(top_teams, 40)
attach(top_teams)
head(top_teams, 40)
team_stats_by_season = read.csv("raw/teams.csv")
team_stats_by_season$percent_w <- team_stats_by_season$w/(team_stats_by_season$w+team_stats_by_season$l)
head(team_stats_by_season)
write.csv(team_stats_by_season, file = "stats/team_stats_by_season.csv")
team_stats_by_season = read.csv("raw/teams.csv")
write.csv(team_stats_by_season, file = "stats/team_stats_by_season.csv")
team_stats_by_season = read.csv("stats/team_stats_by_season.csv")
head(team_stats_by_season[order(-team_stats_by_season$w),])
team_stats_by_season = read.csv("stats/team_stats_by_season.csv")
head(team_stats_by_season[order(-team_stats_by_season$w),])
head(team_stats_by_season)
team_stats_by_season = read.csv("raw/teams.csv")
team_stats_by_season$percent_w <- team_stats_by_season$w/(team_stats_by_season$w+team_stats_by_season$l)
head(team_stats_by_season)
write.csv(team_stats_by_season, file = "stats/team_stats_by_season.csv")
team_stats_by_season = read.csv("stats/team_stats_by_season.csv")
head(team_stats_by_season, 40)
head(team_stats_by_season[order(-team_stats_by_season$w),])
top_teams = subset(team_stats_by_season, playoffs>0)
team_stats_by_season[,12]= sub("^$", "0", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*1st.*", "1", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*Semis", "2", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*Conf\\.\\sFinals", "3", team_stats_by_season[,12])
team_stats_by_season[,12]= sub("Lost\\sFinals", "4", team_stats_by_season[,12])
team_stats_by_season[,12]= sub("Won.*", "5", team_stats_by_season[,12])
top_teams = subset(team_stats_by_season, playoffs>0)
head(team_stats_by_season[order(-team_stats_by_season$w),])
head(team_stats_by_season)
team_stats_by_season = read.csv("raw/teams.csv")
head(team_stats_by_season)
team_stats_by_season$percent_w <- team_stats_by_season$w/(team_stats_by_season$w+team_stats_by_season$l)
head(team_stats_by_season)
write.csv(team_stats_by_season, file = "stats/team_stats_by_season.csv")
head(team_stats_by_season)
team_stats_by_season = read.csv("stats/team_stats_by_season.csv")
head(team_stats_by_season, 10)
head(team_stats_by_season)
team_stats_by_season = read.csv("raw/teams.csv")
head(team_stats_by_season)
team_stats_by_season$percent_w <- team_stats_by_season$w/(team_stats_by_season$w+team_stats_by_season$l)
head(team_stats_by_season)
write.csv(team_stats_by_season, file = "stats/team_stats_by_season.csv")
head(team_stats_by_season)
write.csv(team_stats_by_season, file = "stats/team_stats_by_season.csv")
head(team_stats_by_season)
team_stats_by_season = read.csv("stats/team_stats_by_season.csv")
head(team_stats_by_season, 10)
team_stats_by_season[,13]= sub("^$", "0", team_stats_by_season[,13])
team_stats_by_season[,13]= sub(".*1st.*", "1", team_stats_by_season[,13])
team_stats_by_season[,13]= sub(".*Semis", "2", team_stats_by_season[,13])
team_stats_by_season[,13]= sub(".*Conf\\.\\sFinals", "3", team_stats_by_season[,13])
team_stats_by_season[,13]= sub("Lost\\sFinals", "4", team_stats_by_season[,13])
team_stats_by_season[,13]= sub("Won.*", "5", team_stats_by_season[,13])
head(team_stats_by_season[order(-team_stats_by_season$w),])
top_teams = subset(team_stats_by_season, playoffs>0)
head(top_teams, 40)
plot(playoffs,percent_w)
attach(top_teams)
plot(playoffs,percent_w)
head(top_teams, 40)
head(top_teams, 40)
head(team_salaries_by_season, 10)
team_salaries_by_season = read.csv("stats/team_salaries_by_season.csv")
head(team_salaries_by_season, 10)
head(player_salaries, 10)
boxscores = read.csv("stats/boxscores.csv")
player_per_game = read.csv("stats/player_per_game.csv")
player_per_game_by_season = read.csv("stats/player_per_game_by_season.csv")
player_per_game_by_season_team = read.csv("stats/player_per_game_by_season_team.csv")
team_per_game = read.csv("stats/team_per_game.csv")
team_per_game_by_season = read.csv("stats/team_per_game_by_season.csv")
home_v_away_per_game = read.csv("stats/home_v_away_per_game.csv")
home_v_away_per_game_by_season = read.csv("stats/home_v_away_per_game_by_season.csv")
player_info = read.csv("stats/player_info.csv")
player_salaries = read.csv("stats/player_salaries.csv")
player_salaries_by_season = read.csv("stats/player_salaries_by_season.csv")
team_salaries = read.csv("stats/team_salaries.csv")
team_salaries_by_season = read.csv("stats/team_salaries_by_season.csv")
team_stats_by_season = read.csv("stats/team_stats_by_season.csv")
head(player_per_game, 10)
head(player_per_game_by_season, 10)
head(team_salaries_by_season, 10)
playoff_wins = data.frame(year, 1st, 2nd, 3rd, 4th, champ)
playoff_wins = data.frame(year, first, second, third, fourth, champ)
playoff_wins = data.frame(year=integer(0), first=numeric(0), second=numeric(0), third=numeric(0), fourth=numeric(0), champ=numeric(0))
year = 1986
wins1 = 50
wins2 = 55
wins3 = 60
wins4 = 65
champ = 70
newRow <- data.frame(year=year, first=wins1, second=wins2, third=wins3, fourth=wins4, champ=winschamp)
winschamp = 70
newRow <- data.frame(year=year, first=wins1, second=wins2, third=wins3, fourth=wins4, champ=winschamp)
playoff_wins = rbind(playoff_wins, newRow)
head(playoff_wins)
year = 1987
wins1 = 53
wins2 = 53
wins3 = 62
wins4 = 64
winschamp = 71
newRow <- data.frame(year=year, first=wins1, second=wins2, third=wins3, fourth=wins4, champ=winschamp)
playoff_wins = rbind(playoff_wins, newRow)
head(playoff_wins)
attach(team_stats_by_season)
unique(season)
for(i in 1986:2014){
print i
}
for(i in 1986:2014){
i
}
for(i in 1986:2014){
print(i)
}
playoffdata <- ddply(playoff_teams, c("season", "playoffs"), summarise, mean = mean(w))
playoff_teams = subset(team_stats_by_season, playoffs>0)
head(team_stats_by_season, 40)
team_stats_by_season[,13]= sub("^$", "0", team_stats_by_season[,13])
team_stats_by_season[,13]= sub(".*1st.*", "1", team_stats_by_season[,13])
team_stats_by_season[,13]= sub(".*Semis", "2", team_stats_by_season[,13])
team_stats_by_season[,13]= sub(".*Conf\\.\\sFinals", "3", team_stats_by_season[,13])
team_stats_by_season[,13]= sub("Lost\\sFinals", "4", team_stats_by_season[,13])
team_stats_by_season[,13]= sub("Won.*", "5", team_stats_by_season[,13])
head(team_stats_by_season[order(-team_stats_by_season$w),])
playoff_teams = subset(team_stats_by_season, playoffs>0)
head(playoff_teams, 40)
plot(playoffs,percent_w)
attach(playoff_teams)
plot(playoffs,percent_w)
playoffdata <- ddply(playoff_teams, c("season", "playoffs"), summarise, mean = mean(w))
head(playoffdata)
library(reshape)
playoffmeans <- cast(playoffdata, season~playoffs, mean)
head(playoffmeans, 20)
playoffmeans <- cast(playoffdata, season~playoffs)
playoffmeans <- cast(playoffdata, season~playoffs, mean, value="wins")
playoffmeans <- cast(playoffdata, season~playoffs, mean, value="wins")
playoffmeans <- cast(playoffdata, season~playoffs, mean, value="mean")
head(playoffmeans, 20)
playoffmeans <- cast(playoffdata, season~playoffs, value="mean")
head(playoffmeans, 20)
playoffmeans <- cast(playoffdata, season~playoffs, value="mean")
head(playoffmeans, 27)
head(playoffmeans, 29)
playoffdata <- ddply(playoff_teams, c("season", "playoffs"), summarise, mean = mean(percent_w))
playoffmeans <- cast(playoffdata, season~playoffs, value="mean")
head(playoffmeans, 29)
head(subset(playoff_teams, season=1996), 40)
head(subset(playoff_teams, season==1996), 40)
head(playoffmeans, 29)
plot(playoffmeans$season,playoffmeans$1)
plot(playoffmeans$season,playoffmeans$'1')
par(mfrow=c(2,2))
plot(playoffmeans$season,playoffmeans$'1')
plot(playoffmeans$season,playoffmeans$'2')
plot(playoffmeans$season,playoffmeans$'3')
plot(playoffmeans$season,playoffmeans$'4')
plot(playoffmeans$season,playoffmeans$'5')
par(mfrow=c(2,3))
plot(playoffmeans$season,playoffmeans$'1')
plot(playoffmeans$season,playoffmeans$'2')
plot(playoffmeans$season,playoffmeans$'3')
plot(playoffmeans$season,playoffmeans$'4')
plot(playoffmeans$season,playoffmeans$'5')
head(team_salaries_by_season, 10)
head(team_salaries_by_season, 40)
teamsalarydrops <- c("X")
team_salaries_by_season <- team_salaries_by_season[,!(names(team_salaries_by_season) %in% teamsalarydrops)]
head(team_salaries_by_season, 40)
teamstatsdrops <- c("X")
team_stats_by_season <- team_stats_by_season[,!(names(team_stats_by_season) %in% teamstatsdrops)]
summary(team_stats_by_season$playoffs)
team_stats_by_season[,12]= sub("^$", "0", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*1st.*", "1", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*Semis", "2", team_stats_by_season[,12])
team_stats_by_season[,12]= sub(".*Conf\\.\\sFinals", "3", team_stats_by_season[,12])
team_stats_by_season[,12]= sub("Lost\\sFinals", "4", team_stats_by_season[,12])
team_stats_by_season[,12]= sub("Won.*", "5", team_stats_by_season[,12])
summary(team_stats_by_season$playoffs)
head(team_stats_by_season[order(-team_stats_by_season$w),])
head(team_salaries_by_season)
head(team_stats_by_season[order(-team_stats_by_season$w),])
team_with_salaries <- merge(player_per_game_2014, player_salaries_by_season, by=c("team", "season"))
team_with_salaries <- merge(team_salaries_by_season, team_stats_by_season, by=c("team", "season"))
head(team_with_salaries)
playoff_teams = subset(team_stats_by_season, playoffs>0)
playoffdata <- ddply(playoff_teams, c("season", "playoffs"), summarise,
mean_w = mean(percent_w),
mean_salary = mean(total_salary))
teams_with_salaries <- merge(team_salaries_by_season, team_stats_by_season, by=c("team", "season"))
playoff_teams = subset(teams_with_salaries, playoffs>0)
playoffdata <- ddply(playoff_teams, c("season", "playoffs"), summarise,
mean_w = mean(percent_w),
mean_salary = mean(total_salary))
head(playoffdata)
teams_first = subset(playoff_teams, playoff==1)
teams_first = subset(playoff_teams, playoffs==1)
teams_second = subset(playoff_teams, playoffs==2)
teams_third = subset(playoff_teams, playoffs==3)
teams_fourth = subset(playoff_teams, playoffs==4)
teams_fifth = subset(playoff_teams, playoffs==5)
season_first = subset(playoffdata, playoffs==1)
season_second = subset(playoffdata, playoffs==2)
season_third = subset(playoffdata, playoffs==3)
head(playoffmeans, 29)
head(teams_first)
head(seasons_first, 29)
seasons_first = subset(playoffdata, playoffs==1)
head(seasons_first, 29)
plot(teams_first$percent_w, teams_first$total_salary)
plot(teams_first$percent_w, teams_first$total_salary)
plot(teams_second$percent_w, teams_second$total_salary)
plot(teams_third$percent_w, teams_third$total_salary)
plot(teams_fourth$percent_w, teams_fourth$total_salary)
plot(teams_fifth$percent_w, teams_fifth$total_salary)
plot(seasons_first$percent_w, seasons_first$total_salary)
seasons_first = subset(playoffdata, playoffs==1)
seasons_second = subset(playoffdata, playoffs==2)
seasons_third = subset(playoffdata, playoffs==3)
plot(seasons_first$percent_w, seasons_first$total_salary)
plot(seasons_first$percent_w, seasons_first$total_salary)
head(playoffdata)
plot(seasons_first$percent_w, seasons_first$mean_salary)
plot(seasons_first$mean_w, seasons_first$mean_salary)
plot(seasons_second$mean_w, seasons_second$mean_salary)
plot(seasons_third$mean_w, seasons_third$mean_salary)
playoffmeans <- cast(playoffdata, season~playoffs, value="mean")
playoffmeans <- cast(playoffdata, season~playoffs, value="mean_slary")
playoffmeans <- cast(playoffdata, season~playoffs, value="mean_salary")
head(playoffmeans, 29)
playoffmeans <- cast(playoffdata, season~playoffs, value="mean_w")
head(playoffmeans, 29)
head(team_with_salaries)
total_salaries <- ddply(teams_with_salaries, c("season"), summarise,
total_salary = sum(total_salary))
total_salaries <- ddply(teams_with_salaries, c("season"), summarise,
total_salary = sum(as.numeric(total_salary)))
head(total_salaries)
team_salaries_by_season <- merge(team_salaries_by_season, total_salaries, by=c("season"))
head(team_salaries_by_season)
total_salaries <- ddply(teams_with_salaries, c("season"), summarise,
league_salary = sum(as.numeric(total_salary)))
team_salaries_by_season <- merge(team_salaries_by_season, total_salaries, by=c("season"))
head(team_salaries_by_season)
team_salaries_by_season = read.csv("stats/team_salaries_by_season.csv")
total_salaries <- ddply(teams_with_salaries, c("season"), summarise,
league_salary = sum(as.numeric(total_salary)))
head(total_salaries)
team_salaries_by_season <- merge(team_salaries_by_season, total_salaries, by=c("season"))
head(team_salaries_by_season)
team_salaries_by_season$salary_percentage <- team_salaries_by_season$total_salary/team_salaries_by_season$league_salary
head(team_salaries_by_season)
# Remove x from salaries and join Salaries with Stats
teamsalarydrops <- c("X")
team_salaries_by_season <- team_salaries_by_season[,!(names(team_salaries_by_season) %in% teamsalarydrops)]
head(team_salaries_by_season)
teams_with_salaries <- merge(team_salaries_by_season, team_stats_by_season, by=c("team", "season"))
head(team_with_salaries)
head(team_salaries_by_season)
teams_with_salaries <- merge(team_salaries_by_season, team_stats_by_season, by=c("team", "season"))
head(team_with_salaries)
head(teams_with_salaries)
playoff_teams = subset(teams_with_salaries, playoffs>0)
plot(teams_first$percent_w, teams_first$salary_percentage)
teams_first = subset(playoff_teams, playoffs==1)
plot(teams_first$percent_w, teams_first$salary_percentage)
teams_second = subset(playoff_teams, playoffs==2)
teams_third = subset(playoff_teams, playoffs==3)
teams_fourth = subset(playoff_teams, playoffs==4)
teams_fifth = subset(playoff_teams, playoffs==5)
plot(teams_second$percent_w, teams_second$total_salary)
plot(teams_third$percent_w, teams_third$total_salary)
plot(teams_fourth$percent_w, teams_fourth$total_salary)
plot(teams_fifth$percent_w, teams_fifth$total_salary)
plot(teams_second$percent_w, teams_second$salary_percentage)
plot(teams_first$percent_w, teams_first$salary_percentage)
plot(teams_second$percent_w, teams_second$salary_percentage)
plot(teams_third$percent_w, teams_third$salary_percentage)
plot(teams_fourth$percent_w, teams_fourth$salary_percentage)
plot(teams_fifth$percent_w, teams_fifth$salary_percentage)
playoffmeans <- cast(playoffdata, season~playoffs, value="mean_w")
head(playoffmeans, 29)
head(team_salaries_by_season)
head(teams_with_salaries)
head(team_stats_by_season[order(-team_stats_by_season$w),])
teams_with_salaries$success = team_stats_by_season$percent_w + max(team_stats_by_season$percent_w)*team_stats_by_season$playoffs/5
teams_with_salaries$success = team_stats_by_season$percent_w + max(team_stats_by_season$percent_w)*as.numeric(team_stats_by_season$playoffs)/5
teams_with_salaries$success = max(team_stats_by_season$percent_w)
head(teams_with_salaries)
teams_with_salaries$success = max(team_stats_by_season$percent_w)*as.numeric(team_stats_by_season$playoffs)/5
playoff_teams$success = max(playoff_teams$percent_w)*as.numeric(playoff_teams$playoffs)/5
head(playoff_teams)
playoff_teams$success = team_stats_by_season$percent_w + max(playoff_teams$percent_w)*as.numeric(playoff_teams$playoffs)/5
playoff_teams$success = playoff_teams$percent_w + max(playoff_teams$percent_w)*as.numeric(playoff_teams$playoffs)/5
head(playoff_teams)
attach(playoff_teams)
plot(playoff_teams$success,playoff_teams$salary_percentage)
plot(playoff_teams$salary_percentage, playoff_teams$success)
attach(playoff_teams)
lm.fit=lm(success~salary_percentage, data=playoff_teams)
lm.fit
summary(lm.fit)
abline(lm.fit)
head(playoff_teams)
playoff_teams$salary_skew = playoff_teams$sd_salary/playoff_teams$mean_salary
head(playoff_teams)
playoff_teams$salary_skew = playoff_teams$sd_salary/playoff_teams$total_salary
head(playoff_teams)
playoff_teams$salary_skew = playoff_teams$sd_salary/playoff_teams$mean_salary
head(playoff_teams)
head(playoff_teams[order(-playoff_teams$salary_skew),])
lm.fit=lm(success~salary_percentage+salary_skew, data=playoff_teams)
summary(lm.fit)
team_salaries_by_season$salary_percentage <- team_salaries_by_season$total_salary/team_salaries_by_season$league_salary*100
lm.fit=lm(success~salary_percentage+salary_skew, data=playoff_teams)
summary(lm.fit)
plot(playoff_teams$salary_percentage, playoff_teams$success)
team_salaries_by_season$salary_percentage <- team_salaries_by_season$total_salary/team_salaries_by_season$league_salary*100
teamsalarydrops <- c("X")
team_salaries_by_season <- team_salaries_by_season[,!(names(team_salaries_by_season) %in% teamsalarydrops)]
teams_with_salaries <- merge(team_salaries_by_season, team_stats_by_season, by=c("team", "season"))
playoff_teams = subset(teams_with_salaries, playoffs>0)
plot(playoff_teams$salary_percentage, playoff_teams$success)
playoff_teams = subset(teams_with_salaries, playoffs>0)
playoff_teams$success = playoff_teams$percent_w + max(playoff_teams$percent_w)*as.numeric(playoff_teams$playoffs)/5
playoff_teams$salary_skew = playoff_teams$sd_salary/playoff_teams$mean_salary
plot(playoff_teams$salary_percentage, playoff_teams$success)
playoffdata <- ddply(playoff_teams, c("season", "playoffs"), summarise,
mean_w = mean(percent_w),
mean_salary = mean(total_salary))
head(playoffdata)
lm.fit=lm(success~salary_percentage+salary_skew, data=playoff_teams)
summary(lm.fit)
head(team_salaries_by_season)
head(teams_with_salaries)
playoff_teams = subset(teams_with_salaries, playoffs>0)
playoff_teams$success = playoff_teams$percent_w + max(playoff_teams$percent_w)*as.numeric(playoff_teams$playoffs)/5
head(playoff_teams)
playoff_teams$salary_skew = playoff_teams$sd_salary/playoff_teams$mean_salary
head(playoff_teams)
par(mfrow=c(2,2))
head(playoffmeans, 29)
plot(teams_first$percent_w, teams_first$salary_percentage)
head(playoff_teams)
head(playoff_teams)
playoff_teams$identifier = c(playoff_teams$team,playoff_teams$team)
playoff_teams$identifier = paste(playoff_teams$team,playoff_teams$team)
head(playoff_teams)
playoff_teams$identifier = paste(playoff_teams$season,playoff_teams$team)
head(playoff_teams)
head(playoff_teams)
teams_first = subset(playoff_teams, playoffs==1)
plot(teams_first$percent_w, teams_first$salary_percentage)
par(mfrow=c(1,1))
plot(teams_first$percent_w, teams_first$salary_percentage)
identify(playoffmeans$season,playoffmeans$'1',labels=playoffmeans$identifier)
head(playoff_teams)
teams_first = subset(playoff_teams, playoffs==1)
identify(teams_first$season,teams_first$'1',labels=teams_first$identifier)
plot(teams_first$percent_w, teams_first$salary_percentage)
identify(teams_first$season,teams_first$'1',labels=teams_first$identifier)
