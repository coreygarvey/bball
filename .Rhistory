colleges = read.csv(College.csv)
colleges = read.csv("College.csv")
library(ISLR)
colleges = data(College)
head(colleges)
data(College)
college = read.csv("college.csv", header=T)
attach(College)
head(College)
colleges=College
head(colleges)
college=College
fix(college)
llege)=college[,1]
fix(college
rownames(college)=college[,1]
fix(college)
rownames(college)=college[,1]
fix(college)
rownames(college)=college[,1]
fix(college)
college=college[,-1]
fix(college)
fix(college)
college=college[,-1]
fix(college)
data(College)
college=College
fix(college)
rownames(college)=college[,1]
rownames(college)=college[,1]
ls()
fix(college)
rm(list=ls())
data(College)
college=College
fix(college)
rownames(college)=college[,1]
fix(college)
college=college[,-1]
fix(college)
data(College)
library(ISLR)
data(College)
college=College
fix(college)
rownames(college)=college[,1]
fix(college)
summary(college)
pairs(college)
pairs(college[,1:10])
str(college$Private)
plot?
?plot
?plot
plot(college$Private, college$Outstate, col = c(2,3), varwidth=T, xlab="Elite University", ylab="Out of State Tuition in USD", main="Outstate Tuition plot")
plot(college$Private, college$Outstate, col = c(2,3), varwidth=T, xlab="Elite University", ylab="Out of State Tuition in USD", main="Outstate Tuition plot")
plot(college$Private, college$Outstate, col = c(2,3), varwidth=T, xlab="Private University", ylab="Out of State Tuition in USD", main="Outstate Tuition plot")
Elite=rep("No",nrow(college))
head(college, 5)
Elite[college$Top10perc>50]="Yes"
head(college,5)
Elite=as.factor(Elite)
head(college,5)
college=data.frame(college,Elite)
head(college,5)
plot(collge$Elite, collge$Outstate, col=c(2,3), varwidth=T, xlab="Elite University", ylab="Out of state Tuition in USD", main = "Outstage Tuition plot")
plot(collge$Elite, collge$Outstate, col=c(2,3), varwidth=T, xlab="Elite University", ylab="Out of state Tuition in USD", main = "Outstage Tuition plot")
plot(college$Elite, college$Outstate, col=c(2,3), varwidth=T, xlab="Elite University", ylab="Out of state Tuition in USD", main = "Outstage Tuition plot")
par(mfrow=c(2,2))
hist(college$Books, col=2, breaks=50, xlab="Books", ylab="Count")
hist(college$PHD, col=3, breaks=50, xlab="PhD", ylab="Count")
hist(college$Grad.Rate, col=4, breaks=50, xlab="Grad Rate", ylab="Count")
hist(college$perc.alumni, col=6, breaks=50, xlab="% alumni who donate", ylab="Count")
hist(college$PhD, col=3, breaks=50, xlab="PhD", ylab="Count")
summary(collge$PhD)
summary(college$PhD)
nrow(subset=college[college$PhD==103,])
nrow(subset1=college[college$PhD==103,])
nrow(subset1<-college[college$PhD==103,])
row.names(subset1)
identify(percent, PTS, labels = PLAYER, plot=TRUE)
setwd('/Users/cgarvey/Documents/NBA/bball/')
library(plyr)
library(ggplot2)
library(scatterplot3d)
boxscores = read.csv("stats/boxscores.csv")
player_per_game = read.csv("stats/player_per_game.csv")
player_per_game_by_season = read.csv("stats/player_per_game_by_season.csv")
player_per_game_by_season_team = read.csv("stats/player_per_game_by_season_team.csv")
team_per_game = read.csv("stats/team_per_game.csv")
team_per_game_by_season = read.csv("stats/team_per_game_by_season.csv")
home_v_away_per_game = read.csv("stats/home_v_away_per_game.csv")
home_v_away_per_game_by_season = read.csv("stats/home_v_away_per_game_by_season.csv")
player_info = read.csv("stats/player_info.csv")
player_salaries = read.csv("stats/player_salaries.csv")
player_salaries_by_season = read.csv("stats/player_salaries_by_season.csv")
team_salaries = read.csv("stats/team_salaries.csv")
team_salaries_by_season = read.csv("stats/team_salaries_by_season.csv")
team_stats_by_season = read.csv("raw/teams.csv")
head(boxscores, 10)
head(player_per_game, 10)
head(player_per_game_by_season, 10)
head(player_per_game_by_season_team, 10)
head(team_per_game, 10)
head(team_per_game_by_season, 10)
head(home_v_away_per_game, 10)
head(home_v_away_per_game_by_season, 10)
head(player_info, 10)
head(player_salaries, 10)
head(player_salaries_by_season, 10)
head(team_salaries, 10)
head(team_salaries_by_season, 10)
head(team_stats_by_season, 10)
# Isolate player games
player_games_by_season = player_per_game_by_season[,c("PLAYER", "SEASON", "games")]
head(player_games_by_season,10)
# Stat calculations
boxscores_2014 = subset(boxscores[order(-boxscores$PTS),], SEASON==2014)
head(boxscores_2014)
total_points = sum(boxscores_2014$PTS)
total_assists = sum(boxscores_2014$AST)
total_rebounds = sum(boxscores_2014$TRB)
total_steals = sum(boxscores_2014$STL)
total_minutes = sum(boxscores_2014$minutes)
# Salary calculations
player_salaries_2014 = subset(player_salaries_by_season[order(-player_salaries_by_season$salary),], season==2014)
total_salary = sum(player_salaries_2014$salary)
cash_per_pt = total_salary/total_points
cash_per_ast = total_salary/total_assists
cash_per_trb = total_salary/total_rebounds
cash_per_stl = total_salary/total_steals
cash_per_min = total_salary/total_minutes
cash_per_stat = total_salary/sum(total_points,total_assists,total_rebounds,total_steals)
cash_per_stat
# 2014 team and player stats
team_stats_2014 = subset(team_stats_by_season, season==2014)
player_per_game_team_2014 = subset(player_per_game_by_season_team, SEASON==2014)
player_per_game_2014 = subset(player_per_game_by_season, SEASON==2014)
# PLAYER - Join data sets and drop columns we don't want
player_per_game_2014 <- merge(player_per_game_2014, player_salaries_by_season, by.x=c("PLAYER", "SEASON"), by.y=c("id", "season"))
salarydrops <- c("X.x","X.y","mean_salary")
player_per_game_2014 <- player_per_game_2014[,!(names(player_per_game_2014) %in% salarydrops)]
head(player_per_game_2014,10)
# Payout by stat
player_per_game_2014$pts_payout <- player_per_game_2014$PTS*cash_per_pt
player_per_game_2014$ast_payout <- player_per_game_2014$AST*cash_per_ast
player_per_game_2014$trb_payout <- player_per_game_2014$TRB*cash_per_trb
player_per_game_2014$stl_payout <- player_per_game_2014$STL*cash_per_stl
player_per_game_2014$stat_payout <- (player_per_game_2014$PTS+player_per_game_2014$AST+player_per_game_2014$TRB+player_per_game_2014$STL)*cash_per_stat
player_per_game_2014$min_payout <- player_per_game_2014$minutes*cash_per_min
player_per_game_2014$salary_per <- player_per_game_2014$salary*player_per_game_2014$games
# Isolate important stats, get player relative value (diff) measured as money earned vs money paid
head(player_per_game_2014)
payouts_2014 = player_per_game_2014[,c("PLAYER", "salary", "PTS", "AST", "TRB", "STL", "minutes", "pts_payout", "ast_payout", "trb_payout", "stl_payout", "min_payout", "stat_payout", "salary_per")]
payouts_2014$pts_diff <- payouts_2014$pts_payout - payouts_2014$salary_per
payouts_2014$ast_diff <- payouts_2014$ast_payout - payouts_2014$salary_per
payouts_2014$trb_diff <- payouts_2014$trb_payout - payouts_2014$salary_per
payouts_2014$stl_diff <- payouts_2014$stl_payout - payouts_2014$salary_per
payouts_2014$min_diff <- payouts_2014$min_payout - payouts_2014$salary_per
payouts_2014$stat_diff <- payouts_2014$stat_payout - payouts_2014$salary_per
# PLAYER-TEAM - Join data sets and drop columns we don't want
player_per_game_team_2014 <- merge(player_per_game_team_2014, player_salaries_by_season, by.x=c("PLAYER", "SEASON"), by.y=c("id", "season"))
salarydrops <- c("X.x","X.y","mean_salary")
player_per_game_team_2014 <- player_per_game_team_2014[,!(names(player_per_game_team_2014) %in% salarydrops)]
player_per_game_team_2014 <- merge(player_per_game_team_2014, player_games_by_season, by=c("PLAYER", "SEASON"))
player_per_game_team_2014$eff_salary <- player_per_game_team_2014$salary*(player_per_game_team_2014$games.x/player_per_game_team_2014$games.y)
head(player_per_game_team_2014,10)
head(payouts_2014[order(-payouts_2014$pts_diff),])
head(payouts_2014[order(-payouts_2014$ast_diff),])
head(payouts_2014[order(-payouts_2014$trb_diff),])
head(payouts_2014[order(-payouts_2014$stl_diff),])
head(payouts_2014[order(-payouts_2014$min_diff),])
head(payouts_2014[order(payouts_2014$stat_diff),])
head(player_per_game_2014)
library(MASS)
library(ISLR)
players_2014 = player_per_game_2014
head(players_2014, 5)
names(boxscores_2014)
head(player_salaries_2014)
stats <- merge(boxscores_2014, player_salaries_2014, by.x=c("PLAYER"), by.y=c("id"))
stats_drops <- c("X.x","MP")
stats <- stats[,!(names(stats) %in% stats_drops)]
top_players_2014 = subset(players_2014, PTS>10)
top_players_2014 = top_players_2014[1]
top_list <- top_players_2014[,1]
top_stats_2014 = subset(stats, stats$PLAYER %in% top_list)
head(top_stats_2014)
names(top_stats_2014)
attach(top_stats_2014)
plot(percent,PTS)
identify(percent, PTS, labels = PLAYER, plot=TRUE)
plot(percent,PTS)
identify(percent, PTS, labels = PLAYER, plot=FALSE)
identify(PTS, percent, labels = PLAYER, plot=FALSE)
plot(percent,PTS)
identify(PTS, percent, labels = PLAYER, plot=FALSE)
